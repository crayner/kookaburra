(window.webpackJsonp=window.webpackJsonp||[]).push([["notificationTray"],{"4nQW":function(e,t,n){"use strict";n.r(t);var o=n("q1tI"),i=n.n(o),a=n("i8i4");n("pNMO"),n("4Brf"),n("0oug"),n("4mDm"),n("wLYn"),n("zKZe"),n("uL8W"),n("eoL8"),n("NBAS"),n("ExoC"),n("07d7"),n("PKPk"),n("3bBZ"),n("R5XZ"),n("17x9");function r(e){var t=e.messengerCount,n=e.showMessenger,o=e.messengerTitle,a=t;return i.a.createElement("div",{id:"messageWall",className:"relative"},i.a.createElement("a",{href:"#",title:o,className:0===a?"inactive inline-block relative mr-4 fa-layers fa-fw fa-3x":"inline-block relative mr-4 fa-layers fa-fw fa-3x",onClick:n},0===a?i.a.createElement("span",{className:"far fa-comment-dots text-gray-500"}):i.a.createElement("span",{className:"fas fa-comment-dots  text-yellow-800"},i.a.createElement("span",{className:"fa-layers-counter",style:{color:"white",fontSize:"0.8rem",position:"absolute",top:"18px",left:"6px"}},a))))}function s(e){var t=e.notificationCount,n=e.showNotifications,o=e.notificationTitle,a=t;return i.a.createElement("div",{id:"notifications"},i.a.createElement("a",{className:0===a?"inactive inline-block relative mr-4 fa-layers fa-fw fa-3x":"inline-block relative mr-4 fa-layers fa-fw fa-3x",title:o,onClick:n},0===a?i.a.createElement("span",{className:"far fa-sticky-note text-gray-500"}):i.a.createElement("span",{className:"fas fa-sticky-note text-yellow-500"},i.a.createElement("span",{className:"fa-layers-counter",style:{color:"white",fontSize:"0.8rem",position:"absolute",top:"22px",left:"9px"}},a))))}r.defaultProps={messengerCount:0,messengerTitle:"Message Wall"},s.defaultProps={notificationCount:0,notificationTitle:"Notifications"};var c=n("ohO+"),l=n("J5mc");function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function m(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){function t(e){var n,o,i,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(n=!(i=p(t).call(this,e))||"object"!==u(i)&&"function"!=typeof i?h(o):i).otherProps=f({},e),n.state={notificationCount:0,messengerCount:0,notificationTitle:"Notifications",messengerTitle:"Message Wall"},n.timeout=!0===n.isStaff?1e4:12e4,n.showNotifications=n.showNotifications.bind(h(n)),n.showMessenger=n.showMessenger.bind(h(n)),n.handleLogout=n.handleLogout.bind(h(n)),n.displayTray=!0,n.delay=(a=0,function(e,t){clearTimeout(a),a=setTimeout(e,t)}),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,e),n=t,(o=[{key:"componentDidMount",value:function(){this.displayTray&&(this.loadNotification(250+2e3*Math.random()),this.loadMessenger(250+2e3*Math.random()))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.notificationTime),clearTimeout(this.messengerTime)}},{key:"loadNotification",value:function(e){var t=this;this.notificationTime=setTimeout((function(){Object(l.a)("api/notification/refresh/",{method:"GET"},!1).then((function(e){e.count!==t.state.notiificationCount&&t.setState({notificationCount:e.count,notificationTitle:e.title}),e.redirect&&Object(c.a)("/")})),t.loadNotification(t.timeout)}),e)}},{key:"loadMessenger",value:function(e){var t=this;this.messengerTime=setTimeout((function(){Object(l.a)("api/messenger/refresh/",{method:"GET"},!1).then((function(e){e.count!==t.state.messengerCount&&t.setState({messengerCount:e.count,messengerTitle:e.title}),e.redirect&&Object(c.a)("/")})),t.loadMessenger(t.timeout)}),e)}},{key:"showNotifications",value:function(){this.state.notificationCount>0&&Object(c.a)("/notifications/manage/",{method:"GET"},!1)}},{key:"showMessenger",value:function(){this.state.messengerCount>0&&Object(c.a)("/messenger/today/show/",{method:"GET"},!1)}},{key:"handleLogout",value:function(){Object(c.a)("/logout/",{method:"GET"},!1)}},{key:"render",value:function(){return i.a.createElement("div",{className:"flex flex-row-reverse mb-1"},i.a.createElement(r,{messengerCount:this.state.messengerCount,showMessenger:this.showMessenger,title:this.state.messengerTitle}),i.a.createElement(s,{notificationCount:this.state.notificationCount,showNotifications:this.showNotifications,title:this.state.notificationTitle}))}}])&&m(n.prototype,o),a&&m(n,a),t}(o.Component);d.defaultProps={displayTray:!1,locale:!1};var g=document.getElementById("notificationTray");null===g?Object(a.render)(i.a.createElement("div",null,"Â "),document.getElementById("dumpStuff")):Object(a.render)(i.a.createElement(d,null),g)},J5mc:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("yq1k"),n("zKZe"),n("07d7"),n("5s+n"),n("JTJg");function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function i(e,t,n){var i={};t&&t.headers&&(i=t.headers,delete t.headers),i=o({},i,{"Content-Type":"application/json; charset=utf-8"}),null===n&&(n="en_GB"),!1!==n&&""!==e||(n="");var r=window.location.protocol+"//"+window.location.hostname+"/";return"/"===e[0]&&(e=e.substring(1)),"http"===e.substring(0,4)&&(r=""),fetch(r+n+e,o({},t,{credentials:"same-origin",headers:i})).then(a).then((function(e){return e.text().then((function(e){return e.includes("window.Sfdump")?(console.log(e),""):"string"==typeof e?JSON.parse(e):""}))}))}function a(e){if(e.status>=200&&e.status<400)return e;var t=new Error(e.statusText);throw t.response=e,t}},"ohO+":function(e,t,n){"use strict";function o(e,t,n){var o="_self";t&&"string"==typeof t.target&&(o=t.target);var i="";t&&"string"==typeof t.specs&&(i=t.specs),"boolean"==typeof n&&!1===n&&(n=""),null==n&&(n="en_GB"),""!==n&&(n="/"+n),window.open(window.location.protocol+"//"+window.location.hostname+n+e,o,i)}n.d(t,"a",(function(){return o}))}},[["4nQW","runtime",0,1]]]);